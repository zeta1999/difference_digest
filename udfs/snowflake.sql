CREATE OR REPLACE FUNCTION F_DD_HASH("idx" INT, "element" BIGINT)
	RETURNS BIGINT
  AS 
$$
    ((93824992236885 * BITXOR(element, BITSHIFTRIGHT(element, 32)) % 4294967296) * 
    CASE
      WHEN idx = 0 THEN 1826998997
      WHEN idx = 1 THEN 914390139
      WHEN idx = 2 THEN 207279169
      WHEN idx = 3 THEN 4179003799
      WHEN idx = 4 THEN 1648963021
    END) % 4294967296
$$
;;

CREATE OR REPLACE FUNCTION F_DD_TRAILING_ZEROS(element FLOAT)
  RETURNS FLOAT
  LANGUAGE JAVASCRIPT
  AS 
'
  if(ELEMENT == 0) return 0
  count = 0
  while((ELEMENT & 1) == 0) {
    ELEMENT = ELEMENT >>> 1
    count ++
  }
  return count
';